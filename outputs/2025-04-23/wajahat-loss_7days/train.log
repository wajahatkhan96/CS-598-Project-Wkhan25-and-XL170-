[2025-04-23 01:40:48,124][trainers.trainer][INFO] - {'batch_size': 128,
 'bert_model': 'bert_tiny',
 'device_ids': [0],
 'disable_validation': False,
 'distributed_world_size': 1,
 'dropout': 0.3,
 'embed_model': 'descemb_rnn',
 'enc_embed_dim': 128,
 'enc_hidden_dim': 256,
 'eval_data': None,
 'fold': None,
 'init_bert_params': False,
 'init_bert_params_with_freeze': False,
 'input_path': '/content/drive/MyDrive/DL4H/data_output_path',
 'load_pretrained_weights': False,
 'lr': 0.0001,
 'max_event_len': 150,
 'mlm_prob': 0.3,
 'model': 'ehr_model',
 'model_path': None,
 'n_epochs': 20,
 'patience': 20,
 'pred_embed_dim': 128,
 'pred_hidden_dim': 256,
 'pred_model': 'rnn',
 'ratio': '100',
 'rnn_layer': 1,
 'save_dir': 'checkpoints',
 'save_prefix': 'checkpoint',
 'seed': 1,
 'src_data': 'mimiciii',
 'task': 'los_7day',
 'transfer': False,
 'valid_subsets': ['valid', 'test'],
 'value_mode': 'VA'}
[2025-04-23 01:40:48,220][trainers.trainer][INFO] - EHRModel(
  (embed_model): RNNTextEncoder(
    (subword_embed_layer): SubwordInputLayer(
      (embedding): Embedding(28996, 128, padding_idx=0)
    )
    (model): GRU(128, 256, batch_first=True, dropout=0.3, bidirectional=True)
    (post_encode_proj): Linear(in_features=512, out_features=128, bias=True)
  )
  (pred_model): RNNModel(
    (model): GRU(128, 256, batch_first=True, dropout=0.3)
    (final_proj): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2025-04-23 01:40:48,221][trainers.trainer][INFO] - task: los_7day
[2025-04-23 01:40:48,221][trainers.trainer][INFO] - model: EHRModel
[2025-04-23 01:40:48,221][trainers.trainer][INFO] - num. model params: 4,666,753 (num. trained: 4,666,753)
[2025-04-23 01:41:24,563][datasets.dataset][INFO] - loaded 11921 train samples
[2025-04-23 01:41:42,602][datasets.dataset][INFO] - loaded 3707 valid samples
[2025-04-23 01:41:58,728][datasets.dataset][INFO] - loaded 2908 test samples
[2025-04-23 01:42:04,039][trainers.trainer][INFO] - begin training epoch 1
[2025-04-23 01:43:03,331][train][INFO] - epoch: 1, loss: 0.666, auroc: 0.485, auprc: 0.121
[2025-04-23 01:43:03,331][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:43:06,034][valid][INFO] - epoch: 1, loss: 0.660, auroc: 0.502, auprc: 0.128
[2025-04-23 01:43:06,034][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:43:08,176][test][INFO] - epoch: 1, loss: 1.492, auroc: 0.505, auprc: 0.128
[2025-04-23 01:43:08,177][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:43:08,333][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:43:08,334][trainers.trainer][INFO] - begin training epoch 2
[2025-04-23 01:44:06,898][train][INFO] - epoch: 2, loss: 0.660, auroc: 0.485, auprc: 0.121
[2025-04-23 01:44:06,898][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:44:09,588][valid][INFO] - epoch: 2, loss: 0.657, auroc: 0.502, auprc: 0.128
[2025-04-23 01:44:09,588][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:44:11,719][test][INFO] - epoch: 2, loss: 1.484, auroc: 0.505, auprc: 0.128
[2025-04-23 01:44:11,720][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:44:11,881][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:44:11,882][trainers.trainer][INFO] - begin training epoch 3
[2025-04-23 01:45:10,502][train][INFO] - epoch: 3, loss: 0.656, auroc: 0.485, auprc: 0.121
[2025-04-23 01:45:10,502][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:45:13,227][valid][INFO] - epoch: 3, loss: 0.654, auroc: 0.503, auprc: 0.128
[2025-04-23 01:45:13,228][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:45:15,368][test][INFO] - epoch: 3, loss: 1.477, auroc: 0.505, auprc: 0.128
[2025-04-23 01:45:15,368][trainers.trainer][INFO] - begin training epoch 4
[2025-04-23 01:46:14,040][train][INFO] - epoch: 4, loss: 0.653, auroc: 0.485, auprc: 0.121
[2025-04-23 01:46:14,041][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:46:16,893][valid][INFO] - epoch: 4, loss: 0.651, auroc: 0.503, auprc: 0.128
[2025-04-23 01:46:16,893][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:46:19,032][test][INFO] - epoch: 4, loss: 1.470, auroc: 0.505, auprc: 0.128
[2025-04-23 01:46:19,033][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:46:19,191][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:46:19,191][trainers.trainer][INFO] - begin training epoch 5
[2025-04-23 01:47:17,778][train][INFO] - epoch: 5, loss: 0.650, auroc: 0.486, auprc: 0.122
[2025-04-23 01:47:17,779][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:47:20,656][valid][INFO] - epoch: 5, loss: 0.648, auroc: 0.503, auprc: 0.128
[2025-04-23 01:47:20,657][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:47:22,792][test][INFO] - epoch: 5, loss: 1.463, auroc: 0.505, auprc: 0.128
[2025-04-23 01:47:22,792][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:47:22,945][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:47:22,946][trainers.trainer][INFO] - begin training epoch 6
[2025-04-23 01:48:21,411][train][INFO] - epoch: 6, loss: 0.647, auroc: 0.487, auprc: 0.124
[2025-04-23 01:48:21,411][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:48:24,189][valid][INFO] - epoch: 6, loss: 0.645, auroc: 0.505, auprc: 0.130
[2025-04-23 01:48:24,190][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:48:26,449][test][INFO] - epoch: 6, loss: 1.456, auroc: 0.506, auprc: 0.129
[2025-04-23 01:48:26,449][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:48:26,607][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 01:48:26,607][trainers.trainer][INFO] - begin training epoch 7
[2025-04-23 01:49:25,054][train][INFO] - epoch: 7, loss: 0.643, auroc: 0.487, auprc: 0.124
[2025-04-23 01:49:25,055][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:49:27,775][valid][INFO] - epoch: 7, loss: 0.641, auroc: 0.504, auprc: 0.130
[2025-04-23 01:49:27,776][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:49:29,994][test][INFO] - epoch: 7, loss: 1.449, auroc: 0.506, auprc: 0.129
[2025-04-23 01:49:29,995][trainers.trainer][INFO] - begin training epoch 8
[2025-04-23 01:50:28,468][train][INFO] - epoch: 8, loss: 0.640, auroc: 0.490, auprc: 0.126
[2025-04-23 01:50:28,468][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:50:31,211][valid][INFO] - epoch: 8, loss: 0.638, auroc: 0.504, auprc: 0.130
[2025-04-23 01:50:31,211][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:50:33,353][test][INFO] - epoch: 8, loss: 1.442, auroc: 0.506, auprc: 0.129
[2025-04-23 01:50:33,354][trainers.trainer][INFO] - begin training epoch 9
[2025-04-23 01:51:31,782][train][INFO] - epoch: 9, loss: 0.637, auroc: 0.490, auprc: 0.128
[2025-04-23 01:51:31,782][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:51:34,484][valid][INFO] - epoch: 9, loss: 0.635, auroc: 0.504, auprc: 0.130
[2025-04-23 01:51:34,484][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:51:36,617][test][INFO] - epoch: 9, loss: 1.436, auroc: 0.506, auprc: 0.129
[2025-04-23 01:51:36,618][trainers.trainer][INFO] - begin training epoch 10
[2025-04-23 01:52:35,313][train][INFO] - epoch: 10, loss: 0.634, auroc: 0.492, auprc: 0.129
[2025-04-23 01:52:35,313][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:52:38,048][valid][INFO] - epoch: 10, loss: 0.632, auroc: 0.504, auprc: 0.130
[2025-04-23 01:52:38,048][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:52:40,216][test][INFO] - epoch: 10, loss: 1.429, auroc: 0.506, auprc: 0.129
[2025-04-23 01:52:40,217][trainers.trainer][INFO] - begin training epoch 11
[2025-04-23 01:53:38,812][train][INFO] - epoch: 11, loss: 0.631, auroc: 0.494, auprc: 0.132
[2025-04-23 01:53:38,813][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:53:41,572][valid][INFO] - epoch: 11, loss: 0.629, auroc: 0.504, auprc: 0.130
[2025-04-23 01:53:41,572][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:53:43,747][test][INFO] - epoch: 11, loss: 1.422, auroc: 0.505, auprc: 0.129
[2025-04-23 01:53:43,747][trainers.trainer][INFO] - begin training epoch 12
[2025-04-23 01:54:42,128][train][INFO] - epoch: 12, loss: 0.627, auroc: 0.495, auprc: 0.134
[2025-04-23 01:54:42,129][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:54:44,985][valid][INFO] - epoch: 12, loss: 0.626, auroc: 0.504, auprc: 0.130
[2025-04-23 01:54:44,985][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:54:47,144][test][INFO] - epoch: 12, loss: 1.415, auroc: 0.505, auprc: 0.129
[2025-04-23 01:54:47,144][trainers.trainer][INFO] - begin training epoch 13
[2025-04-23 01:55:45,494][train][INFO] - epoch: 13, loss: 0.624, auroc: 0.495, auprc: 0.134
[2025-04-23 01:55:45,495][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:55:48,341][valid][INFO] - epoch: 13, loss: 0.624, auroc: 0.504, auprc: 0.130
[2025-04-23 01:55:48,341][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:55:50,585][test][INFO] - epoch: 13, loss: 1.409, auroc: 0.505, auprc: 0.129
[2025-04-23 01:55:50,589][trainers.trainer][INFO] - begin training epoch 14
[2025-04-23 01:56:49,110][train][INFO] - epoch: 14, loss: 0.621, auroc: 0.496, auprc: 0.135
[2025-04-23 01:56:49,110][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:56:51,816][valid][INFO] - epoch: 14, loss: 0.621, auroc: 0.504, auprc: 0.130
[2025-04-23 01:56:51,816][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:56:54,085][test][INFO] - epoch: 14, loss: 1.402, auroc: 0.505, auprc: 0.129
[2025-04-23 01:56:54,086][trainers.trainer][INFO] - begin training epoch 15
[2025-04-23 01:57:52,537][train][INFO] - epoch: 15, loss: 0.618, auroc: 0.496, auprc: 0.136
[2025-04-23 01:57:52,537][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:57:55,225][valid][INFO] - epoch: 15, loss: 0.618, auroc: 0.504, auprc: 0.130
[2025-04-23 01:57:55,225][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:57:57,367][test][INFO] - epoch: 15, loss: 1.396, auroc: 0.505, auprc: 0.129
[2025-04-23 01:57:57,367][trainers.trainer][INFO] - begin training epoch 16
[2025-04-23 01:58:55,846][train][INFO] - epoch: 16, loss: 0.615, auroc: 0.496, auprc: 0.136
[2025-04-23 01:58:55,846][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 01:58:58,577][valid][INFO] - epoch: 16, loss: 0.615, auroc: 0.504, auprc: 0.130
[2025-04-23 01:58:58,577][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 01:59:00,739][test][INFO] - epoch: 16, loss: 1.390, auroc: 0.507, auprc: 0.129
[2025-04-23 01:59:00,740][trainers.trainer][INFO] - begin training epoch 17
[2025-04-23 01:59:59,351][train][INFO] - epoch: 17, loss: 0.612, auroc: 0.496, auprc: 0.136
[2025-04-23 01:59:59,351][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 02:00:02,073][valid][INFO] - epoch: 17, loss: 0.613, auroc: 0.506, auprc: 0.131
[2025-04-23 02:00:02,073][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 02:00:04,234][test][INFO] - epoch: 17, loss: 1.384, auroc: 0.508, auprc: 0.129
[2025-04-23 02:00:04,234][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 02:00:04,421][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-23 02:00:04,422][trainers.trainer][INFO] - begin training epoch 18
[2025-04-23 02:01:03,250][train][INFO] - epoch: 18, loss: 0.608, auroc: 0.497, auprc: 0.137
[2025-04-23 02:01:03,251][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 02:01:05,983][valid][INFO] - epoch: 18, loss: 0.610, auroc: 0.506, auprc: 0.131
[2025-04-23 02:01:05,983][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 02:01:08,103][test][INFO] - epoch: 18, loss: 1.378, auroc: 0.508, auprc: 0.130
[2025-04-23 02:01:08,104][trainers.trainer][INFO] - begin training epoch 19
[2025-04-23 02:02:06,557][train][INFO] - epoch: 19, loss: 0.605, auroc: 0.499, auprc: 0.139
[2025-04-23 02:02:06,558][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 02:02:09,389][valid][INFO] - epoch: 19, loss: 0.608, auroc: 0.503, auprc: 0.130
[2025-04-23 02:02:09,389][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 02:02:11,592][test][INFO] - epoch: 19, loss: 1.373, auroc: 0.506, auprc: 0.130
[2025-04-23 02:02:11,592][trainers.trainer][INFO] - begin training epoch 20
[2025-04-23 02:03:09,912][train][INFO] - epoch: 20, loss: 0.601, auroc: 0.501, auprc: 0.143
[2025-04-23 02:03:09,912][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-23 02:03:12,630][valid][INFO] - epoch: 20, loss: 0.606, auroc: 0.503, auprc: 0.130
[2025-04-23 02:03:12,631][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-23 02:03:14,892][test][INFO] - epoch: 20, loss: 1.368, auroc: 0.506, auprc: 0.130
[2025-04-23 02:03:14,894][__main__][INFO] - done training
