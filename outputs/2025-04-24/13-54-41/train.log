[2025-04-24 04:54:41,051][trainers.trainer][INFO] - {'batch_size': 128,
 'bert_model': 'bert_tiny',
 'device_ids': [0],
 'disable_validation': False,
 'distributed_world_size': 1,
 'dropout': 0.3,
 'embed_model': 'descemb_rnn',
 'enc_embed_dim': 128,
 'enc_hidden_dim': 256,
 'eval_data': 'eicu',
 'fold': None,
 'init_bert_params': False,
 'init_bert_params_with_freeze': False,
 'input_path': '/content/drive/MyDrive/DL4H/data_output_path',
 'load_pretrained_weights': False,
 'lr': 0.0001,
 'max_event_len': 150,
 'mlm_prob': 0.3,
 'model': 'ehr_model',
 'model_path': '/content/drive/MyDrive/DL4H/DescEmb/outputs/2025-04-22/mortality-wk/checkpoints/checkpoint_best.pt',
 'n_epochs': 20,
 'patience': 5,
 'pred_embed_dim': 128,
 'pred_hidden_dim': 256,
 'pred_model': 'rnn',
 'ratio': '100',
 'rnn_layer': 1,
 'save_dir': 'checkpoints',
 'save_prefix': 'checkpoint',
 'seed': 1,
 'src_data': 'mimiciii',
 'task': 'mortality',
 'transfer': True,
 'valid_subsets': ['valid', 'test'],
 'value_mode': 'NV'}
[2025-04-24 04:54:41,089][models.ehr_model][INFO] - Preparing to transfer pre-trained model /content/drive/MyDrive/DL4H/DescEmb/outputs/2025-04-22/mortality-wk/checkpoints/checkpoint_best.pt
[2025-04-24 04:54:41,315][models.ehr_model][INFO] - Loaded checkpoint /content/drive/MyDrive/DL4H/DescEmb/outputs/2025-04-22/mortality-wk/checkpoints/checkpoint_best.pt
[2025-04-24 04:54:41,315][models.ehr_model][WARNING] - transferred model has unexpected or missing keys.
[2025-04-24 04:54:41,315][trainers.trainer][INFO] - EHRModel(
  (embed_model): RNNTextEncoder(
    (subword_embed_layer): SubwordInputLayer(
      (embedding): Embedding(28996, 128, padding_idx=0)
    )
    (model): GRU(128, 256, batch_first=True, dropout=0.3, bidirectional=True)
    (post_encode_proj): Linear(in_features=512, out_features=128, bias=True)
  )
  (pred_model): RNNModel(
    (model): GRU(128, 256, batch_first=True, dropout=0.3)
    (final_proj): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2025-04-24 04:54:41,316][trainers.trainer][INFO] - task: mortality
[2025-04-24 04:54:41,316][trainers.trainer][INFO] - model: EHRModel
[2025-04-24 04:54:41,316][trainers.trainer][INFO] - num. model params: 4,666,753 (num. trained: 4,666,753)
[2025-04-24 04:55:12,042][datasets.dataset][INFO] - loaded 11873 train samples
[2025-04-24 04:55:24,936][datasets.dataset][INFO] - loaded 3707 valid samples
[2025-04-24 04:55:37,164][datasets.dataset][INFO] - loaded 2956 test samples
[2025-04-24 04:55:42,499][trainers.trainer][INFO] - begin training epoch 1
[2025-04-24 04:56:21,394][train][INFO] - epoch: 1, loss: 0.662, auroc: 0.507, auprc: 0.094
[2025-04-24 04:56:21,395][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:56:23,223][valid][INFO] - epoch: 1, loss: 0.654, auroc: 0.503, auprc: 0.084
[2025-04-24 04:56:23,224][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:56:24,588][test][INFO] - epoch: 1, loss: 1.447, auroc: 0.503, auprc: 0.089
[2025-04-24 04:56:24,588][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:56:24,740][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:56:24,741][trainers.trainer][INFO] - begin training epoch 2
[2025-04-24 04:57:02,583][train][INFO] - epoch: 2, loss: 0.655, auroc: 0.507, auprc: 0.094
[2025-04-24 04:57:02,583][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:57:04,311][valid][INFO] - epoch: 2, loss: 0.651, auroc: 0.504, auprc: 0.084
[2025-04-24 04:57:04,311][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:57:05,699][test][INFO] - epoch: 2, loss: 1.439, auroc: 0.504, auprc: 0.089
[2025-04-24 04:57:05,700][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:57:05,853][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:57:05,854][trainers.trainer][INFO] - begin training epoch 3
[2025-04-24 04:57:44,389][train][INFO] - epoch: 3, loss: 0.651, auroc: 0.507, auprc: 0.094
[2025-04-24 04:57:44,390][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:57:46,355][valid][INFO] - epoch: 3, loss: 0.647, auroc: 0.504, auprc: 0.084
[2025-04-24 04:57:46,355][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:57:47,712][test][INFO] - epoch: 3, loss: 1.431, auroc: 0.504, auprc: 0.089
[2025-04-24 04:57:47,713][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:57:47,868][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:57:47,869][trainers.trainer][INFO] - begin training epoch 4
[2025-04-24 04:58:25,790][train][INFO] - epoch: 4, loss: 0.648, auroc: 0.507, auprc: 0.094
[2025-04-24 04:58:25,790][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:58:27,509][valid][INFO] - epoch: 4, loss: 0.644, auroc: 0.504, auprc: 0.084
[2025-04-24 04:58:27,509][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:58:28,876][test][INFO] - epoch: 4, loss: 1.423, auroc: 0.503, auprc: 0.089
[2025-04-24 04:58:28,876][trainers.trainer][INFO] - begin training epoch 5
[2025-04-24 04:59:06,717][train][INFO] - epoch: 5, loss: 0.644, auroc: 0.507, auprc: 0.094
[2025-04-24 04:59:06,717][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:59:08,438][valid][INFO] - epoch: 5, loss: 0.640, auroc: 0.504, auprc: 0.084
[2025-04-24 04:59:08,438][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:59:09,826][test][INFO] - epoch: 5, loss: 1.415, auroc: 0.503, auprc: 0.089
[2025-04-24 04:59:09,826][trainers.trainer][INFO] - begin training epoch 6
[2025-04-24 04:59:47,609][train][INFO] - epoch: 6, loss: 0.641, auroc: 0.507, auprc: 0.094
[2025-04-24 04:59:47,609][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 04:59:49,329][valid][INFO] - epoch: 6, loss: 0.637, auroc: 0.505, auprc: 0.084
[2025-04-24 04:59:49,329][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 04:59:50,722][test][INFO] - epoch: 6, loss: 1.408, auroc: 0.504, auprc: 0.089
[2025-04-24 04:59:50,723][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:59:50,880][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 04:59:50,881][trainers.trainer][INFO] - begin training epoch 7
[2025-04-24 05:00:29,100][train][INFO] - epoch: 7, loss: 0.637, auroc: 0.508, auprc: 0.095
[2025-04-24 05:00:29,100][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:00:30,826][valid][INFO] - epoch: 7, loss: 0.633, auroc: 0.505, auprc: 0.084
[2025-04-24 05:00:30,827][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:00:32,283][test][INFO] - epoch: 7, loss: 1.401, auroc: 0.504, auprc: 0.089
[2025-04-24 05:00:32,283][trainers.trainer][INFO] - begin training epoch 8
[2025-04-24 05:01:10,011][train][INFO] - epoch: 8, loss: 0.634, auroc: 0.508, auprc: 0.095
[2025-04-24 05:01:10,012][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:01:11,815][valid][INFO] - epoch: 8, loss: 0.630, auroc: 0.505, auprc: 0.084
[2025-04-24 05:01:11,816][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:01:13,304][test][INFO] - epoch: 8, loss: 1.393, auroc: 0.504, auprc: 0.089
[2025-04-24 05:01:13,305][trainers.trainer][INFO] - Saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 05:01:13,518][trainers.trainer][INFO] - Finished saving checkpoint to checkpoints/checkpoint_best.pt
[2025-04-24 05:01:13,519][trainers.trainer][INFO] - begin training epoch 9
[2025-04-24 05:01:51,380][train][INFO] - epoch: 9, loss: 0.631, auroc: 0.509, auprc: 0.096
[2025-04-24 05:01:51,381][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:01:53,216][valid][INFO] - epoch: 9, loss: 0.627, auroc: 0.504, auprc: 0.084
[2025-04-24 05:01:53,217][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:01:54,615][test][INFO] - epoch: 9, loss: 1.386, auroc: 0.504, auprc: 0.089
[2025-04-24 05:01:54,616][trainers.trainer][INFO] - begin training epoch 10
[2025-04-24 05:02:32,677][train][INFO] - epoch: 10, loss: 0.627, auroc: 0.511, auprc: 0.099
[2025-04-24 05:02:32,677][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:02:34,441][valid][INFO] - epoch: 10, loss: 0.623, auroc: 0.504, auprc: 0.084
[2025-04-24 05:02:34,441][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:02:35,815][test][INFO] - epoch: 10, loss: 1.379, auroc: 0.503, auprc: 0.089
[2025-04-24 05:02:35,815][trainers.trainer][INFO] - begin training epoch 11
[2025-04-24 05:03:13,686][train][INFO] - epoch: 11, loss: 0.624, auroc: 0.512, auprc: 0.100
[2025-04-24 05:03:13,686][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:03:15,411][valid][INFO] - epoch: 11, loss: 0.620, auroc: 0.504, auprc: 0.084
[2025-04-24 05:03:15,412][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:03:16,776][test][INFO] - epoch: 11, loss: 1.373, auroc: 0.503, auprc: 0.089
[2025-04-24 05:03:16,777][trainers.trainer][INFO] - begin training epoch 12
[2025-04-24 05:03:54,507][train][INFO] - epoch: 12, loss: 0.621, auroc: 0.512, auprc: 0.101
[2025-04-24 05:03:54,508][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:03:56,213][valid][INFO] - epoch: 12, loss: 0.617, auroc: 0.504, auprc: 0.084
[2025-04-24 05:03:56,213][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:03:57,579][test][INFO] - epoch: 12, loss: 1.366, auroc: 0.503, auprc: 0.089
[2025-04-24 05:03:57,580][trainers.trainer][INFO] - begin training epoch 13
[2025-04-24 05:04:35,456][train][INFO] - epoch: 13, loss: 0.617, auroc: 0.515, auprc: 0.103
[2025-04-24 05:04:35,457][trainers.trainer][INFO] - begin validation on 'valid' subset
[2025-04-24 05:04:37,185][valid][INFO] - epoch: 13, loss: 0.614, auroc: 0.503, auprc: 0.084
[2025-04-24 05:04:37,185][trainers.trainer][INFO] - begin validation on 'test' subset
[2025-04-24 05:04:38,593][test][INFO] - epoch: 13, loss: 1.359, auroc: 0.503, auprc: 0.089
[2025-04-24 05:04:38,593][utils.trainer_utils][INFO] - early stop since valid performance hasn't improved for last 5 runs
[2025-04-24 05:04:38,594][__main__][INFO] - done training
